<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬é–“è‹±ä½œæ–‡ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚° é€²æ—ç®¡ç†</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <style>
        body { font-family: 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif; }
        .status-not-started { border-left: 5px solid #d1d5db; }
        .status-in-progress { border-left: 5px solid #f59e0b; }
        .status-completed { border-left: 5px solid #10b981; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .toast-in { animation: toastIn 0.5s ease-in-out; }
        @keyframes toastIn { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .btn {
            transition: all 0.2s ease-in-out;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .filter-btn-active {
            background-color: #374151 !important;
            color: #ffffff !important;
        }
        .achievement-locked {
            filter: grayscale(100%);
            opacity: 0.6;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .details-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
    </style>
    </head>
<body class="bg-stone-100 text-stone-800">

    <div class="container mx-auto max-w-7xl p-4 sm:p-6 lg:p-8">

        <header class="mb-8 text-center">
            <h1 class="text-3xl sm:text-4xl font-bold text-stone-700">ã©ã‚“ã©ã‚“è©±ã™ãŸã‚ã®ç¬é–“è‹±ä½œæ–‡ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h1>
            <p class="text-lg text-stone-500 mt-2">ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–é€²æ—ç®¡ç†</p>
        </header>

        <section id="dashboard" class="mb-8 p-6 bg-white rounded-xl shadow-lg">
            <div class="flex flex-wrap justify-between items-center gap-2 mb-4">
                <h2 class="text-2xl font-bold text-stone-700">å­¦ç¿’é€²æ—ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ <span id="dashboard-title" class="text-lg text-stone-500 font-normal"></span></h2>
                <div class="flex gap-2">
                    <button id="achievements-btn" class="btn bg-amber-500 hover:bg-amber-600 text-white py-1 px-3 rounded-lg text-sm whitespace-nowrap">ğŸ† å®Ÿç¸¾</button>
                    <button id="reset-data-btn" class="btn bg-red-500 hover:bg-red-600 text-white py-1 px-3 rounded-lg text-sm whitespace-nowrap">ãƒªã‚»ãƒƒãƒˆ</button>
                </div>
            </div>
             <p class="text-stone-600 mb-6">ä¸‹ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã§è¡¨ç¤ºã™ã‚‹Partã‚’é¸æŠã™ã‚‹ã¨ã€ã“ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®å†…å®¹ã‚‚é€£å‹•ã—ã¦æ›´æ–°ã•ã‚Œã¾ã™ã€‚</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-center">
                <div class="chart-container relative h-64 w-full max-w-sm mx-auto md:col-span-1">
                    <canvas id="progressChart"></canvas>
                </div>
                <div id="stats" class="grid grid-cols-2 sm:grid-cols-3 gap-4 text-center md:col-span-2">
                    <div class="bg-stone-50 p-4 rounded-lg">
                        <p class="text-4xl font-bold text-green-500" id="completedCount">0</p>
                        <p class="text-sm text-stone-500">å®Œäº†</p>
                    </div>
                    <div class="bg-stone-50 p-4 rounded-lg">
                        <p class="text-4xl font-bold text-amber-500" id="inProgressCount">0</p>
                        <p class="text-sm text-stone-500">å®Ÿæ–½ä¸­</p>
                    </div>
                    <div class="bg-stone-50 p-4 rounded-lg">
                        <p class="text-4xl font-bold text-gray-500" id="notStartedCount">0</p>
                        <p class="text-sm text-stone-500">æœªç€æ‰‹</p>
                    </div>
                     <div class="bg-stone-50 p-4 rounded-lg">
                        <p class="text-4xl font-bold text-stone-700" id="totalCount">0</p>
                        <p class="text-sm text-stone-500">åˆè¨ˆ</p>
                    </div>
                    <div class="bg-sky-50 p-4 rounded-lg">
                        <p class="text-4xl font-bold text-sky-500" id="currentStreak">0</p>
                        <p class="text-sm text-stone-500">ç¶™ç¶šæ—¥æ•° (å…¨ä½“)</p>
                    </div>
                    <div class="bg-orange-50 p-4 rounded-lg">
                        <p class="text-4xl font-bold text-orange-500" id="totalRepsCount">0</p>
                        <p class="text-sm text-stone-500">ç·å‘¨å›æ•°</p>
                    </div>
                </div>
            </div>
        </section>

        <section>
            <div class="flex flex-wrap justify-center items-center gap-x-4 gap-y-2 mb-6">
                <button data-filter="all" class="filter-btn btn bg-gray-800 text-white py-2 px-5 rounded-full shadow-md">ã™ã¹ã¦</button>
                <div class="flex gap-2 border border-gray-300 rounded-full p-1">
                    <button data-filter="1-1" class="filter-btn btn bg-white text-stone-700 py-1 px-4 rounded-full">1-1</button>
                    <button data-filter="1-2" class="filter-btn btn bg-white text-stone-700 py-1 px-4 rounded-full">1-2</button>
                </div>
                <div class="flex gap-2 border border-gray-300 rounded-full p-1">
                    <button data-filter="2-1" class="filter-btn btn bg-white text-stone-700 py-1 px-4 rounded-full">2-1</button>
                    <button data-filter="2-2" class="filter-btn btn bg-white text-stone-700 py-1 px-4 rounded-full">2-2</button>
                    <button data-filter="2-3" class="filter-btn btn bg-white text-stone-700 py-1 px-4 rounded-full">2-3</button>
                </div>
                 <div class="flex gap-2 border border-gray-300 rounded-full p-1">
                    <button data-filter="3-1" class="filter-btn btn bg-white text-stone-700 py-1 px-4 rounded-full">3-1</button>
                    <button data-filter="3-2" class="filter-btn btn bg-white text-stone-700 py-1 px-4 rounded-full">3-2</button>
                </div>
            </div>

            <div id="chapters-grid" class="space-y-3">
            </div>
        </section>
    </div>

    <div id="reset-modal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm mx-4 fade-in">
            <h3 class="text-lg font-bold mb-4">ç¢ºèª</h3>
            <p class="text-stone-600 mb-6">æœ¬å½“ã«ã™ã¹ã¦ã®å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚</p>
            <div class="flex justify-end gap-4">
                <button id="cancel-reset-btn" class="btn bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-4 rounded-lg">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button id="confirm-reset-btn" class="btn bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg">ãƒªã‚»ãƒƒãƒˆã™ã‚‹</button>
            </div>
        </div>
    </div>
    
    <div id="achievements-modal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-2xl mx-4 fade-in max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">å®Ÿç¸¾ä¸€è¦§</h3>
                <button id="close-achievements-btn" class="text-2xl font-bold">&times;</button>
            </div>
            <div id="achievements-list" class="overflow-y-auto grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"></div>
        </div>
    </div>
    
    <div id="ai-modal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-lg mx-4 fade-in max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">âœ¨ AIä¾‹æ–‡ãƒãƒ£ãƒ¬ãƒ³ã‚¸</h3>
                <button id="close-ai-modal-btn" class="text-2xl font-bold">&times;</button>
            </div>
            <div id="ai-modal-body" class="overflow-y-auto">
                <div id="ai-modal-loader" class="flex justify-center items-center h-48">
                    <div class="loader"></div>
                </div>
                <div id="ai-modal-content"></div>
            </div>
        </div>
    </div>

    <div id="timer-modal" class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm mx-4 fade-in text-center">
            <h3 class="text-xl font-bold mb-2">ã‚¿ã‚¤ãƒ æ¸¬å®š</h3>
            <p id="timer-chapter-title" class="text-stone-600 mb-4"></p>
            <div id="timer-display" class="text-6xl font-mono font-bold my-6">00:00.0</div>
            <div class="flex justify-center gap-4">
                <button id="timer-start-stop-btn" class="btn bg-green-500 hover:bg-green-600 text-white py-3 px-8 rounded-lg text-lg">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
                <button id="timer-record-btn" class="btn bg-sky-500 hover:bg-sky-600 text-white py-3 px-6 rounded-lg hidden">è¨˜éŒ²ã™ã‚‹</button>
                <button id="timer-cancel-btn" class="btn bg-gray-300 hover:bg-gray-400 text-gray-800 py-3 px-6 rounded-lg">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            </div>
        </div>
    </div>

    <div id="toast" class="fixed bottom-5 right-5 bg-green-500 text-white py-3 px-5 rounded-lg shadow-xl hidden toast-in"></div>

    <script>
        const CHAPTER_STORAGE_KEY = 'shunkanEigoProgress_v3';
        const STATS_STORAGE_KEY = 'shunkanEigoStats_v3';

        const bookData = [
            { id: 'part-1-1-this-that', part: 1, subPart: '1-1', title: 'this / that' }, { id: 'part-1-1-these-those', part: 1, subPart: '1-1', title: 'these / those' }, { id: 'part-1-1-what-is-are', part: 1, subPart: '1-1', title: 'What is (are) ~ ?' }, { id: 'part-1-1-pronoun-subject', part: 1, subPart: '1-1', title: 'äººç§°ä»£åè©ã®ä¸»æ ¼' }, { id: 'part-1-1-pronoun-possessive', part: 1, subPart: '1-1', title: 'äººç§°ä»£åè©ã®æ‰€æœ‰æ ¼' }, { id: 'part-1-1-who-is-are', part: 1, subPart: '1-1', title: 'Who is (are) ~ ?' }, { id: 'part-1-1-general-verb', part: 1, subPart: '1-1', title: 'ä¸€èˆ¬å‹•è©' }, { id: 'part-1-1-how-many-much', part: 1, subPart: '1-1', title: 'how many (much) ~' }, { id: 'part-1-1-pronoun-object', part: 1, subPart: '1-1', title: 'äººç§°ä»£åè©ã®ç›®çš„æ ¼' }, { id: 'part-1-1-pronoun-possessive-independent', part: 1, subPart: '1-1', title: 'äººç§°ä»£åè©ã®ç‹¬ç«‹æ‰€æœ‰æ ¼' }, { id: 'part-1-1-imperative-lets', part: 1, subPart: '1-1', title: 'å‘½ä»¤æ–‡ / Let\'s ~' }, 
            { id: 'part-1-2-whose', part: 1, subPart: '1-2', title: 'whose ~' }, { id: 'part-1-2-where', part: 1, subPart: '1-2', title: 'where ~' }, { id: 'part-1-2-when', part: 1, subPart: '1-2', title: 'when ~' }, { id: 'part-1-2-which', part: 1, subPart: '1-2', title: 'which ~' }, { id: 'part-1-2-it', part: 1, subPart: '1-2', title: 'it ~' }, { id: 'part-1-2-what-time', part: 1, subPart: '1-2', title: 'What time ~ ?' }, { id: 'part-1-2-how', part: 1, subPart: '1-2', title: 'how ~' }, { id: 'part-1-2-how-old-tall', part: 1, subPart: '1-2', title: 'How old (tall) ~ ?' }, { id: 'part-1-2-who-subject', part: 1, subPart: '1-2', title: 'ç–‘å•è©ä¸»èªã® who' }, { id: 'part-1-2-can', part: 1, subPart: '1-2', title: 'can' }, { id: 'part-1-2-present-progressive', part: 1, subPart: '1-2', title: 'ç¾åœ¨é€²è¡Œå½¢' }, { id: 'part-1-2-there-is-are', part: 1, subPart: '1-2', title: 'There is (are) ~' },
            { id: 'part-2-1-past-tense', part: 2, subPart: '2-1', title: 'éå»å½¢' }, { id: 'part-2-1-past-progressive', part: 2, subPart: '2-1', title: 'éå»é€²è¡Œå½¢' }, { id: 'part-2-1-when-clause', part: 2, subPart: '2-1', title: 'whenç¯€' }, { id: 'part-2-1-general-verb-svc', part: 2, subPart: '2-1', title: 'ä¸€èˆ¬å‹•è©ã®SVC' }, { id: 'part-2-1-svo-to-for', part: 2, subPart: '2-1', title: 'SVO + to (for)' }, { id: 'part-2-1-svoo', part: 2, subPart: '2-1', title: 'SVOO' }, { id: 'part-2-1-will-simple-future', part: 2, subPart: '2-1', title: 'will (å˜ç´”æœªæ¥)' }, { id: 'part-2-1-will-intention', part: 2, subPart: '2-1', title: 'will (æ„å¿—æœªæ¥)' }, { id: 'part-2-1-will-shall-request', part: 2, subPart: '2-1', title: 'will (ä¾é ¼) / shall (ç”³ã—å‡ºãƒ»èª˜ã„)' }, { id: 'part-2-1-be-going-to', part: 2, subPart: '2-1', title: 'be going to' }, { id: 'part-2-1-must-may', part: 2, subPart: '2-1', title: 'must / may' }, { id: 'part-2-1-have-to', part: 2, subPart: '2-1', title: 'have to' }, { id: 'part-2-1-be-able-to', part: 2, subPart: '2-1', title: 'be able to' },
            { id: 'part-2-2-exclamatory', part: 2, subPart: '2-2', title: 'æ„Ÿå˜†æ–‡' }, { id: 'part-2-2-infinitive-noun', part: 2, subPart: '2-2', title: 'ä¸å®šè©â€•åè©çš„ç”¨æ³•' }, { id: 'part-2-2-infinitive-adverb-purpose', part: 2, subPart: '2-2', title: 'ä¸å®šè©â€•å‰¯è©çš„ç”¨æ³•(ç›®çš„)' }, { id: 'part-2-2-infinitive-adverb-reason', part: 2, subPart: '2-2', title: 'ä¸å®šè©â€•å‰¯è©çš„ç”¨æ³•(æ„Ÿæƒ…ã®åŸå› )' }, { id: 'part-2-2-infinitive-adjective', part: 2, subPart: '2-2', title: 'ä¸å®šè©â€•å½¢å®¹è©çš„ç”¨æ³•' }, { id: 'part-2-2-gerund', part: 2, subPart: '2-2', title: 'å‹•åè©' }, { id: 'part-2-2-as-as-comparison', part: 2, subPart: '2-2', title: 'åŸç´šæ¯”è¼ƒ' }, { id: 'part-2-2-comparative-er', part: 2, subPart: '2-2', title: 'æ¯”è¼ƒç´šâ€•erå½¢' }, { id: 'part-2-2-superlative-est', part: 2, subPart: '2-2', title: 'æœ€ä¸Šç´šâ€•estå½¢' }, { id: 'part-2-2-comparative-more', part: 2, subPart: '2-2', title: 'æ¯”è¼ƒç´šâ€•more' }, { id: 'part-2-2-superlative-most', part: 2, subPart: '2-2', title: 'æœ€ä¸Šç´šâ€•most' }, { id: 'part-2-2-comparative-adverb', part: 2, subPart: '2-2', title: 'æ¯”è¼ƒç´šâ€•å‰¯è©' },
            { id: 'part-2-3-superlative-adverb', part: 2, subPart: '2-3', title: 'æœ€ä¸Šç´šâ€•å‰¯è©' }, { id: 'part-2-3-interrogative-comparison', part: 2, subPart: '2-3', title: 'æ¯”è¼ƒç´šã€æœ€ä¸Šç´šã‚’ä½¿ã£ãŸç–‘å•è©ã®æ–‡' }, { id: 'part-2-3-present-perfect-continuous', part: 2, subPart: '2-3', title: 'ç¾åœ¨å®Œäº†â€•ç¶™ç¶š' }, { id: 'part-2-3-present-perfect-completion', part: 2, subPart: '2-3', title: 'ç¾åœ¨å®Œäº†â€•å®Œäº†' }, { id: 'part-2-3-present-perfect-experience', part: 2, subPart: '2-3', title: 'ç¾åœ¨å®Œäº†â€•çµŒé¨“' }, { id: 'part-2-3-present-perfect-progressive', part: 2, subPart: '2-3', title: 'ç¾åœ¨å®Œäº†â€•é€²è¡Œå½¢' }, { id: 'part-2-3-that-clause', part: 2, subPart: '2-3', title: 'thatç¯€' }, { id: 'part-2-3-passive-1', part: 2, subPart: '2-3', title: 'å—èº«â€•1' }, { id: 'part-2-3-passive-2', part: 2, subPart: '2-3', title: 'å—èº«â€•2' },
            { id: 'part-3-1-subordinate-conjunction-1', part: 3, subPart: '3-1', title: 'å¾“å±ç¯€ã‚’å°ãæ¥ç¶šè©â€•1' }, { id: 'part-3-1-subordinate-conjunction-2', part: 3, subPart: '3-1', title: 'å¾“å±ç¯€ã‚’å°ãæ¥ç¶šè©â€•2' }, { id: 'part-3-1-indirect-question', part: 3, subPart: '3-1', title: 'é–“æ¥ç–‘å•æ–‡' }, { id: 'part-3-1-interrogative-to-infinitive', part: 3, subPart: '3-1', title: 'ç–‘å•è© + toä¸å®šè©' }, { id: 'part-3-1-formal-subject-it', part: 3, subPart: '3-1', title: 'å½¢å¼ä¸»èªã®it' }, { id: 'part-3-1-svo-to-infinitive', part: 3, subPart: '3-1', title: 'SVO + toä¸å®šè©' }, { id: 'part-3-1-svoc', part: 3, subPart: '3-1', title: 'SVOC' }, { id: 'part-3-1-present-participle-modifier', part: 3, subPart: '3-1', title: 'ç¾åœ¨åˆ†è©ä¿®é£¾' }, { id: 'part-3-1-past-participle-modifier', part: 3, subPart: '3-1', title: 'éå»åˆ†è©ä¿®é£¾' }, { id: 'part-3-1-relative-pronoun-subject-person', part: 3, subPart: '3-1', title: 'é–¢ä¿‚ä»£åè©ãƒ»ä¸»æ ¼(äºº)' }, { id: 'part-3-1-relative-pronoun-subject-non-person', part: 3, subPart: '3-1', title: 'é–¢ä¿‚ä»£åè©ãƒ»ä¸»æ ¼(äººä»¥å¤–)' },
            { id: 'part-3-2-relative-pronoun-possessive', part: 3, subPart: '3-2', title: 'é–¢ä¿‚ä»£åè©ãƒ»æ‰€æœ‰æ ¼ whose ã¨ of which' }, { id: 'part-3-2-relative-pronoun-object-person', part: 3, subPart: '3-2', title: 'é–¢ä¿‚ä»£åè©ãƒ»ç›®çš„æ ¼(äºº)' }, { id: 'part-3-2-relative-pronoun-object-non-person', part: 3, subPart: '3-2', title: 'é–¢ä¿‚ä»£åè©ãƒ»ç›®çš„æ ¼(äººä»¥å¤–)' }, { id: 'part-3-2-relative-pronoun-what', part: 3, subPart: '3-2', title: 'å…ˆè¡Œè©ã‚’å«ã‚€é–¢ä¿‚ä»£åè© what' }, { id: 'part-3-2-too-to', part: 3, subPart: '3-2', title: 'too ~ to ...' }, { id: 'part-3-2-enough-to', part: 3, subPart: '3-2', title: 'enough ~ to ...' }, { id: 'part-3-2-so-that', part: 3, subPart: '3-2', title: 'so ~ that ...' }, { id: 'part-3-2-bare-infinitive-perception', part: 3, subPart: '3-2', title: 'åŸå‹ä¸å®šè©ãƒ»çŸ¥è¦š' }, { id: 'part-3-2-bare-infinitive-causative', part: 3, subPart: '3-2', title: 'åŸå‹ä¸å®šè©ãƒ»ä½¿å½¹' }, { id: 'part-3-2-relative-adverb-where', part: 3, subPart: '3-2', title: 'é–¢ä¿‚å‰¯è©ãƒ»where' }, { id: 'part-3-2-relative-adverb-when', part: 3, subPart: '3-2', title: 'é–¢ä¿‚å‰¯è©ãƒ»when' }
        ];

        let chapters = [];
        let stats = {};
        let progressChart = null;
        let currentFilter = 'all';
        let timerInterval = null;
        let timerStartTime = 0;
        let currentTimerChapterId = null;

        const achievements = [
            { id: 'first_step', title: 'ã¯ã˜ã‚ã®ä¸€æ­©', description: 'æœ€åˆã®Chapterã‚’å®Œäº†ã™ã‚‹', emoji: 'ğŸŒ±', condition: (s, c) => c.filter(ch => ch.status === 'completed').length >= 1 },
            { id: 'ten_completed', title: 'ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—', description: '10å€‹ã®Chapterã‚’å®Œäº†ã™ã‚‹', emoji: 'ğŸ”¥', condition: (s, c) => c.filter(ch => ch.status === 'completed').length >= 10 },
            { id: 'part1_master', title: 'Part 1 åˆ¶è¦‡', description: 'Part 1ã®Chapterã‚’å…¨ã¦å®Œäº†ã™ã‚‹', emoji: 'ğŸ¥‡', condition: (s, c) => c.filter(ch => ch.part === 1).every(ch => ch.status === 'completed') },
            { id: 'part2_master', title: 'Part 2 åˆ¶è¦‡', description: 'Part 2ã®Chapterã‚’å…¨ã¦å®Œäº†ã™ã‚‹', emoji: 'ğŸ¥ˆ', condition: (s, c) => c.filter(ch => ch.part === 2).every(ch => ch.status === 'completed') },
            { id: 'part3_master', title: 'Part 3 åˆ¶è¦‡', description: 'Part 3ã®Chapterã‚’å…¨ã¦å®Œäº†ã™ã‚‹', emoji: 'ğŸ¥‰', condition: (s, c) => c.filter(ch => ch.part === 3).every(ch => ch.status === 'completed') },
            { id: 'full_master', title: 'å®Œå…¨åˆ¶è¦‡', description: 'å…¨ã¦ã®Chapterã‚’å®Œäº†ã™ã‚‹', emoji: 'ğŸ‘‘', condition: (s, c) => c.every(ch => ch.status === 'completed') },
            { id: 'streak_3', title: 'ä¸‰æ—¥åŠä¸»å’æ¥­', description: '3æ—¥é–“é€£ç¶šã§å­¦ç¿’ã™ã‚‹', emoji: 'ğŸƒ', condition: s => s.currentStreak >= 3 },
            { id: 'streak_7', title: 'ç¶™ç¶šã¯åŠ›ãªã‚Š', description: '7æ—¥é–“é€£ç¶šã§å­¦ç¿’ã™ã‚‹', emoji: 'ğŸ’ª', condition: s => s.currentStreak >= 7 },
            { id: 'streak_30', title: 'ç¿’æ…£ã®é”äºº', description: '30æ—¥é–“é€£ç¶šã§å­¦ç¿’ã™ã‚‹', emoji: 'ğŸ§˜', condition: s => s.currentStreak >= 30 },
        ];

        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            renderDashboard(currentFilter);
            renderCards(currentFilter);
            setupEventListeners();
        });
        
        function loadData() {
            const savedChaptersJSON = localStorage.getItem(CHAPTER_STORAGE_KEY);
            const savedStatsJSON = localStorage.getItem(STATS_STORAGE_KEY);
            
            const loadedChapters = savedChaptersJSON ? JSON.parse(savedChaptersJSON) : {};
            
            chapters = bookData.map(bookChapter => {
                const savedChapter = loadedChapters[bookChapter.id];
                return {
                    ...bookChapter,
                    status: savedChapter ? savedChapter.status : 'not-started',
                    reps: savedChapter ? savedChapter.reps : [],
                };
            });

            const defaultStats = {
                lastActivityDate: null,
                currentStreak: 0,
                maxStreak: 0,
                unlockedAchievements: []
            };
            stats = savedStatsJSON ? { ...defaultStats, ...JSON.parse(savedStatsJSON) } : defaultStats;
        }
        
        function resetAllData() {
            chapters.forEach(chapter => {
                chapter.status = 'not-started';
                chapter.reps = [];
            });
            stats = {
                lastActivityDate: null,
                currentStreak: 0,
                maxStreak: 0,
                unlockedAchievements: []
            };
            saveChapters();
            saveStats();
        }

        function
